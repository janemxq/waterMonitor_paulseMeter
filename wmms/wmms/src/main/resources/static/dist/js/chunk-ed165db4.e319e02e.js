(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ed165db4"],{aab0:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Form",{ref:"form",attrs:{model:e.formValidate,rules:e.ruleValidate,"label-width":90}},[a("FormItem",{attrs:{label:"名称",prop:"villageName"}},[a("Input",{attrs:{placeholder:"请输入登录账号",clearable:""},model:{value:e.formValidate.villageName,callback:function(t){e.$set(e.formValidate,"villageName",t)},expression:"formValidate.villageName"}})],1),a("FormItem",{attrs:{label:"排序字段",prop:"sortId"}},[a("Input",{attrs:{placeholder:"请输入排序字段",clearable:""},model:{value:e.formValidate.sortId,callback:function(t){e.$set(e.formValidate,"sortId",e._n(t))},expression:"formValidate.sortId"}})],1),a("FormItem",{attrs:{label:"地址",prop:"address"}},[a("Input",{attrs:{placeholder:"请输入地址",clearable:""},model:{value:e.formValidate.address,callback:function(t){e.$set(e.formValidate,"address",t)},expression:"formValidate.address"}})],1)],1)},i=[],s=(a("6b54"),a("ac6a"),a("456d"),{name:"add",props:{show:Boolean,data:Object,modalParams:Object},data:function(){var e=this;return{formValidate:{villageName:"",sortId:"",address:""},ruleValidate:{sortId:[{required:!0,type:"number",message:"请输入顺序",trigger:"blur"},{validator:function(t,a,r){e.$rule.ruleNumber(t,a,r,5)},type:"number",trigger:"blur"}],villageName:[{required:!0,message:"请输入村庄名称",trigger:"blur"},{validator:function(t,a,r){e.$rule.ruleLength(t,a,r,200)},trigger:"blur"}],address:[{required:!0,message:"请输入村庄地址",trigger:"blur"},{validator:function(t,a,r){e.$rule.ruleLength(t,a,r,200)},trigger:"blur"}]}}},watch:{show:function(){this.init()}},mounted:function(){this.init()},methods:{init:function(){var e=this;this.show?this.data&&(Object.keys(this.formValidate).map((function(t){e.formValidate[t]=e.data[t]})),Object.assign(this.formValidate,{isValid:"number"!==typeof this.data.isValid||!!this.data.isValid,serial:"number"===typeof this.data.serial?this.data.serial.toString():this.data.isValid||""})):this.handleReset()},handleSubmit:function(){var e=this;return new Promise((function(t,a){e.$refs["form"].validate((function(r){r?t(Object.assign({},"edit"===e.modalParams.type&&e.data,{createUserId:localStorage.getItem("userId")},e.formValidate,{updateUserId:localStorage.getItem("userId")},{isValid:e.formValidate.isValid?1:0})):a("填写内容有误，请查验")}))}))},handleReset:function(){this.$refs["form"]&&this.$refs["form"].resetFields()}}}),n=s,l=a("2877"),o=Object(l["a"])(n,r,i,!1,null,"5d58a217",null);t["default"]=o.exports},ee4e:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("tableTemplate",{attrs:{addModule:!1,handleSubmit:e.handleSubmit,modalParams:e.modalParams,columns:e.columns,seek:e.seek,params:e.params,dataCallBack:e.dataCallBack,title:e.title}},[a("addOrEdit",{ref:"add",attrs:{slot:"add",show:e.modalParams.show,modalParams:e.modalParams},slot:"add"}),a("addOrEdit",{ref:"edit",attrs:{slot:"edit",show:e.modalParams.show,data:e.roleData,modalParams:e.modalParams},slot:"edit"})],1)},i=[],s=(a("8e6e"),a("ac6a"),a("456d"),a("ade3"));a("7f7f");function n(){return[{key:"userName",align:"center",title:"用户"},{key:"villageName",align:"center",title:"所在村落"},{key:"groupName",align:"center",title:"表井名称"},{key:"meterSn",align:"center",title:"编号"},{key:"num",align:"center",title:"水表读数"},{key:"volume",align:"center",title:"码盘值"},{key:"createTime",align:"center",title:"创建时间"}]}function l(){var e=this;return[{type:"seek",key:"userSn",title:"用户名",data:[],remoteMethod:function(t){e.seek[0].loading=!0,e.sysApi.findUser({name:t,current:1,size:99}).then((function(t){e.seek[0].data=t.data.records.map((function(e){return e.value=e.sn,e.name="".concat(e.name,"(").concat(e.phone||e.villageName,")"),e}))})).finally((function(){e.seek[0].loading=!1}))},loading:!1},{type:"time",month:"datetime",key:"createdTimeStart",title:"开始时间",format:"yyyy-MM-dd HH:mm:ss"},{type:"time",key:"createdTimeEnd",month:"datetime",title:"结束时间",format:"yyyy-MM-dd HH:mm:ss"}]}var o={current:1,size:10},d={show:!1,width:600,modalLoading:!0,type:"add",title:"新增",maskClosable:!1},c="读表记录",m=a("23f4"),u=a("2f62");function f(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?f(Object(a),!0).forEach((function(t){Object(s["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var p={name:"Log",data:function(){return{columns:n.call(this),seek:l.call(this),params:o,modalParams:d,roleData:{},title:c,api:this.$api.WaterManage,sysApi:this.$api.System}},components:{addOrEdit:a("aab0").default,groupTree:m["a"],layout:m["b"]},created:function(){},methods:h(h({},Object(u["e"])(["setCount"])),{},{dataCallBack:function(e){return this.api.getWsMeterReader(e).then((function(e){return{content:e.data.records,total:e.data.total}}))},handleDelete:function(e){var t=this;this.api.delWsMeterReader({id:e.id}).then((function(){t.$Message.success("删除用户".concat(e.userName,"的用水记录成功！")),t.setCount()}))},handleSubmit:function(){var e=this;return this.$refs[this.modalParams.type].handleSubmit().then((function(t){var a=e.modalParams.type;return"add"===a?e.api.addWsMeterReader(t).then((function(t){return e.$Message.success("新增用户".concat(item.userName,"的用水记录成功！")),e.setCount(),Promise.resolve(t)})).catch((function(e){return Promise.reject(e)})):e.api.updateWsMeterReader(t).then((function(t){return e.$Message.success("修改用户".concat(item.userName,"的用水记录成功！")),e.setCount(),Promise.resolve(t)})).catch((function(e){return Promise.reject(e)}))}))},edit:function(e){Object.assign(this.roleData,e),Object.assign(this.modalParams,{show:!0,width:600,modalLoading:!0,type:"edit",title:"修改"})},changeTree:function(e){e.villageId?this.params.villageId=e.villageId:this.params.villageId=void 0,this.setCount(),console.log(e.villageId)}})},g=p,b=a("2877"),y=Object(b["a"])(g,r,i,!1,null,"5a2ce078",null);t["default"]=y.exports}}]);