(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-27fe6ddd"],{"3a43":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("tableTemplate",{attrs:{addModule:!0,handleSubmit:e.handleSubmit,modalParams:e.modalParams,columns:e.columns,seek:e.seek,params:e.params,dataCallBack:e.dataCallBack,title:e.title}},[a("addOrEdit",{ref:"add",attrs:{slot:"add",show:e.modalParams.show,modalParams:e.modalParams},slot:"add"}),a("addOrEdit",{ref:"edit",attrs:{slot:"edit",show:e.modalParams.show,data:e.roleData,modalParams:e.modalParams},slot:"edit"})],1)},l=[],n=(a("8e6e"),a("ac6a"),a("456d"),a("ade3")),i=a("67d3");function o(){var e=this;return[{key:"groupName",align:"center",title:"表井名称"},{key:"villageName",title:"村名",align:"center"},{key:"address",title:"设备地址",align:"center"},{key:"createTime",title:"创建时间",align:"center"},{key:"updateTime",title:"更新时间",align:"center"},{title:"最后修改人",align:"center",render:i["a"]},{key:"",title:"操作",align:"center",width:180,render:function(t,a){return t("div",[t("Button",{props:{type:"warning",size:"small"},on:{click:function(){e.edit(a.row)}}},"修改"),t("Poptip",{style:{marginLeft:"8px",textAlign:"left",marginRight:"8px",display:"1"===a.row.deleted?"none":""},props:{confirm:!0,title:"是否确认删除"},on:{"on-ok":function(){e.handleDelete(a.row)}}},[t("Button",{props:{type:"error",size:"small"}},"删除")])])}}]}function s(){return[]}var d={current:1,size:10},c={show:!1,width:600,modalLoading:!0,type:"add",title:"新增",maskClosable:!1},u="表井列表",m=a("2f62");function f(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?f(Object(a),!0).forEach((function(t){Object(n["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var g={name:"Well",data:function(){return{columns:o.call(this),seek:s.call(this),params:d,modalParams:c,roleData:{},title:u,api:this.$api.System}},components:{addOrEdit:a("7bf1").default},created:function(){},methods:p(p({},Object(m["e"])(["setCount"])),{},{dataCallBack:function(e){return this.api.getWsGroup(e).then((function(e){return{content:e.data.records,total:e.data.total}}))},handleDelete:function(e){var t=this;this.api.delWsGroup({id:e.id}).then((function(){t.$Message.success("删除水井".concat(e.groupName,"成功！")),t.setCount()}))},handleSubmit:function(){var e=this;return this.$refs[this.modalParams.type].handleSubmit().then((function(t){var a=e.modalParams.type;return"add"===a?e.api.addWsGroup(t).then((function(a){return e.$Message.success("新增水井".concat(t.groupName,"成功！")),e.setCount(),Promise.resolve(a)})).catch((function(e){return Promise.reject(e)})):e.api.updateWsGroup(t).then((function(a){return e.$Message.success("修改水井".concat(t.groupName,"成功！")),e.setCount(),Promise.resolve(a)})).catch((function(e){return Promise.reject(e)}))}))},edit:function(e){Object.assign(this.roleData,e),Object.assign(this.modalParams,{show:!0,width:600,modalLoading:!0,type:"edit",title:"修改"})}})},h=g,b=a("2877"),v=Object(b["a"])(h,r,l,!1,null,"3385063c",null);t["default"]=v.exports},"67d3":function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return l}));a("13cb");function r(e,t){return e("span",{style:{width:"12px",height:"12px",borderRadius:"50%",background:t.row[t.column.key]?"#1ba784":"#ff4000",display:"inline-block",boxShadow:"0 0 5px 0 ".concat(t.row[t.column.key]?"#1ba784":"#ff4000"),verticalAlign:"middle"}})}function l(e,t){return e("span",{},t.row.updateUserId?t.row.updateUserId:t.row.createUserId)}},"7bf1":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Form",{ref:"form",staticStyle:{"min-height":"300px"},attrs:{model:e.formValidate,rules:e.ruleValidate,"label-width":90}},[a("FormItem",{attrs:{label:"表井名称",prop:"groupName"}},[a("Input",{attrs:{placeholder:"请输入表井名称",clearable:""},model:{value:e.formValidate.groupName,callback:function(t){e.$set(e.formValidate,"groupName",t)},expression:"formValidate.groupName"}})],1),a("FormItem",{attrs:{label:"表井编号",prop:"sn"}},[a("Input",{attrs:{placeholder:"请输入表井编号(采集器出厂编号，例如BJ00001)",clearable:"",disabled:"edit"===e.modalParams.type},model:{value:e.formValidate.sn,callback:function(t){e.$set(e.formValidate,"sn",t)},expression:"formValidate.sn"}})],1),a("FormItem",{attrs:{label:"村庄",prop:"villageSn"}},[a("Select",{on:{"on-change":e.onChange},model:{value:e.formValidate.villageSn,callback:function(t){e.$set(e.formValidate,"villageSn",t)},expression:"formValidate.villageSn"}},e._l(e.VillageAll,(function(t){return a("Option",{key:t.sn,attrs:{value:t.sn}},[e._v(e._s(t.villageName))])})),1)],1),a("FormItem",{attrs:{label:"设备地址",prop:"address"}},[a("Input",{attrs:{placeholder:"请输入设备地址(4位16进制，例如ff01)",clearable:""},model:{value:e.formValidate.address,callback:function(t){e.$set(e.formValidate,"address",t)},expression:"formValidate.address"}})],1)],1)},l=[],n=(a("20d6"),a("ac6a"),a("456d"),{name:"add",props:{show:Boolean,data:Object,modalParams:Object},data:function(){var e=this;return{formValidate:{sn:"",groupName:"",villageSn:"",villageName:"",villageId:"",id:"",address:""},VillageAll:[],api:this.$api.System,ruleValidate:{groupName:[{required:!0,message:"请输入表井名称",trigger:"blur"},{validator:function(t,a,r){e.$rule.ruleLengthMin(t,a,r,[3,20])},trigger:"blur"}],villageSn:[{required:!0,message:"请选择村庄",trigger:"change"}],sn:[{required:!0,message:"请输入表井编号",trigger:"blur"},{validator:function(t,a,r){e.$rule.ruleNumAndLetMin(t,a,r,[2,80])},trigger:"blur"}],address:[{required:!0,message:"请输入设备地址",trigger:"change"},{validator:function(e,t,a){/^([0-9]|[a-f]|[A-F]){4}$/.test(t)||""===t?a():a("设备地址格式为4位十六进制数值")},trigger:"blur"}]}}},watch:{show:function(){this.init()}},mounted:function(){this.init()},methods:{init:function(){var e=this;this.show?(this.getVillageAll(),this.data&&Object.keys(this.formValidate).map((function(t){e.formValidate[t]=e.data[t]}))):this.handleReset()},getVillageAll:function(){var e=this;this.api.getVillageAll().then((function(t){e.VillageAll=t.data}))},handleSubmit:function(){var e=this;return new Promise((function(t,a){e.$refs["form"].validate((function(r){r?t(Object.assign({},"edit"===e.modalParams.type&&e.data,"add"===e.modalParams.type&&{createUserId:localStorage.getItem("userId")},e.formValidate,"edit"===e.modalParams.type&&{updateUserId:localStorage.getItem("userId")})):a("填写内容有误，请查验")}))}))},handleReset:function(){this.$refs["form"]&&this.$refs["form"].resetFields()},onChange:function(e){var t=this.VillageAll.findIndex((function(t){return t.sn===e}));-1!==t&&(this.formValidate.villageName=this.VillageAll[t].villageName,this.formValidate.villageId=this.VillageAll[t].id)}}}),i=n,o=a("2877"),s=Object(o["a"])(i,r,l,!1,null,"29b41d1e",null);t["default"]=s.exports}}]);