(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-393f00b2"],{"063e":function(t,e,a){},"13e7":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"slip"},[a("Form",{ref:"form",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":100}},[a("FormItem",{staticClass:"slip-item",attrs:{label:"用户:"}},[t._v(" "+t._s(t.data.userName||"未知用户")+" ")]),a("FormItem",{staticClass:"slip-item",attrs:{label:"累计用水:"}},[t._v(" "+t._s(t.data.waterSum)+" ")]),a("FormItem",{staticClass:"slip-item",attrs:{label:"缴费时间:"}},[t._v(" "+t._s(t.data.newTime)+" ")]),a("FormItem",{staticClass:"slip-item",attrs:{label:"原余额:"}},[t._v(" "+t._s(t.data.balance)+" ")]),a("FormItem",{staticClass:"slip-item",attrs:{label:"欠费金额:"}},[t._v(" "+t._s(t.data.toPayAccount)+" ")]),a("FormItem",{staticClass:"slip-item",attrs:{label:"收款金额:"}},[t._v(" "+t._s(t.formValidate.realPay)+" ")]),a("FormItem",{staticClass:"slip-item",attrs:{label:"账户余额:"}},[t._v(" "+t._s(t.balance)+" ")])],1)],1)},n=[],s={name:"affirm",props:{show:Boolean,data:Object,modalParams:Object},data:function(){return{formValidate:{isSlip:!0,meterId:"",payment:"cash",realPay:""},balance:0,ruleValidate:{realPay:[{required:!0,type:"number",message:"请输入收款金额",trigger:"blur"},{validator:function(t,e,a){var r=/(^[1-9]\d{0,7}$)|(^\.\d{1,2}$)|(^[1-9]\d{0,7}\.\d{1,2}$)/;e<1?a(new Error("输入的金额必须大于1!")):r.test(e)||a(new Error("只能输入7位数字或者小数点后只能保留两位!")),a()},trigger:"blur"}]}}},watch:{show:function(){this.init()}},mounted:function(){this.init()},methods:{init:function(){this.show&&(console.log(this.modalParams),Object.assign(this.formValidate,this.data),console.log(this.formValidate.balance,this.formValidate.realPay,this.formValidate.toPayAccount),this.balance=(this.formValidate.balance+this.formValidate.realPay-this.formValidate.toPayAccount).toFixed(2))},handleSubmit:function(){var t=this;return new Promise((function(e,a){t.$refs["form"].validate((function(r){r?e(Object.assign({meterId:t.formValidate.meterId,payment:t.formValidate.payment,realPay:t.formValidate.realPay,isSlip:t.formValidate.isSlip,userName:t.data.userName},t.data)):a("填写内容有误，请查验")}))}))},handleReset:function(){this.$refs["form"]&&this.$refs["form"].resetFields()}}},o=s,i=(a("170f"),a("2877")),l=Object(i["a"])(o,r,n,!1,null,"77a24e5d",null);e["default"]=l.exports},"170f":function(t,e,a){"use strict";var r=a("063e"),n=a.n(r);n.a},1913:function(t,e,a){},3601:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"slip"},[a("Form",{ref:"form",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":100}},[a("FormItem",{staticClass:"slip-item",attrs:{label:"用户:"}},[t._v(" "+t._s(t.data.userName||"未知用户")+" ")]),a("FormItem",{staticClass:"slip-item",attrs:{label:"起码:"}},[t._v(" "+t._s(t.data.preNumber)+" ")]),a("FormItem",{staticClass:"slip-item",attrs:{label:"止码:"}},[t._v(" "+t._s(t.data.lastNumber)+" ")]),a("FormItem",{staticClass:"slip-item",attrs:{label:"用水量:"}},[t._v(" "+t._s(t.data.toPayWaterVolume)+" ")]),a("FormItem",{staticClass:"slip-item",attrs:{label:"累计用水:"}},[t._v(" "+t._s(t.data.waterSum)+" ")]),a("FormItem",{staticClass:"slip-item",attrs:{label:"缴费时间:"}},[t._v(" "+t._s(t.data.newTime)+" ")]),a("FormItem",{staticClass:"slip-item",attrs:{label:"欠费金额:"}},[t._v(" "+t._s(t.data.toPayAccount)+" ")]),a("FormItem",{staticClass:"slip-item",attrs:{label:"余额:"}},[t._v(" "+t._s(t.data.balance)+" ")]),a("FormItem",{attrs:{label:"是否打印凭条:",prop:"isSlip"}},[a("i-switch",{model:{value:t.formValidate.isSlip,callback:function(e){t.$set(t.formValidate,"isSlip",e)},expression:"formValidate.isSlip"}},[a("span",{attrs:{slot:"open"},slot:"open"},[t._v("是")]),a("span",{attrs:{slot:"close"},slot:"close"},[t._v("否")])])],1),a("FormItem",{attrs:{label:"支付方式:",prop:"payment"}},[a("RadioGroup",{attrs:{type:"button"},model:{value:t.formValidate.payment,callback:function(e){t.$set(t.formValidate,"payment",e)},expression:"formValidate.payment"}},[a("Radio",{attrs:{label:"cash"}},[t._v("现金")]),a("Radio",{attrs:{label:"alipay"}},[t._v("支付宝")]),a("Radio",{attrs:{label:"wechatpay"}},[t._v("微信")])],1)],1),a("FormItem",{attrs:{label:"收款金额:",prop:"realPay"}},[a("Input",{attrs:{placeholder:"请输入收款金额"},model:{value:t.formValidate.realPay,callback:function(e){t.$set(t.formValidate,"realPay",t._n(e))},expression:"formValidate.realPay"}})],1)],1)],1)},n=[],s={name:"payWS",props:{show:Boolean,data:Object,modalParams:Object},data:function(){return{formValidate:{isSlip:!0,meterId:"",payment:"cash",realPay:""},ruleValidate:{realPay:[{required:!0,type:"number",message:"请输入收款金额",trigger:"blur"},{validator:function(t,e,a){var r=/(^[1-9]\d{0,7}$)|(^\.\d{1,2}$)|(^[1-9]\d{0,7}\.\d{1,2}$)/;e<1?a(new Error("输入的金额必须大于1!")):r.test(e)||a(new Error("只能输入7位数字或者小数点后只能保留两位!")),a()},trigger:"blur"}]}}},watch:{show:function(){this.init()}},mounted:function(){this.init()},methods:{init:function(){this.show&&Object.assign(this.formValidate,{isSlip:!0,meterId:this.data.id,realPay:""})},handleSubmit:function(){var t=this;return new Promise((function(e,a){t.$refs["form"].validate((function(r){r?e(Object.assign({meterId:t.formValidate.meterId,payment:t.formValidate.payment,realPay:t.formValidate.realPay,isSlip:t.formValidate.isSlip,userName:t.data.userName},t.data)):a("填写内容有误，请查验")}))}))},handleReset:function(){this.$refs["form"]&&this.$refs["form"].resetFields()}}},o=s,i=(a("67ba"),a("2877")),l=Object(i["a"])(o,r,n,!1,null,"4a00eecd",null);e["default"]=l.exports},"58cd":function(t,e,a){"use strict";var r=a("1913"),n=a.n(r);n.a},"5a0c":function(t,e,a){!function(e,a){t.exports=a()}(0,(function(){"use strict";var t="millisecond",e="second",a="minute",r="hour",n="day",s="week",o="month",i="quarter",l="year",u=/^(\d{4})-?(\d{1,2})-?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d{1,3})?$/,c=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m=function(t,e,a){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(a)+t},f={s:m,z:function(t){var e=-t.utcOffset(),a=Math.abs(e),r=Math.floor(a/60),n=a%60;return(e<=0?"+":"-")+m(r,2,"0")+":"+m(n,2,"0")},m:function(t,e){var a=12*(e.year()-t.year())+(e.month()-t.month()),r=t.clone().add(a,o),n=e-r<0,s=t.clone().add(a+(n?-1:1),o);return Number(-(a+(e-r)/(n?r-s:s-r))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(u){return{M:o,y:l,w:s,d:n,D:"date",h:r,m:a,s:e,ms:t,Q:i}[u]||String(u||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},d={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},h="en",p={};p[h]=d;var y=function(t){return t instanceof v},b=function(t,e,a){var r;if(!t)return h;if("string"==typeof t)p[t]&&(r=t),e&&(p[t]=e,r=t);else{var n=t.name;p[n]=t,r=n}return!a&&r&&(h=r),r||!a&&h},g=function(t,e){if(y(t))return t.clone();var a="object"==typeof e?e:{};return a.date=t,a.args=arguments,new v(a)},w=f;w.l=b,w.i=y,w.w=function(t,e){return g(t,{locale:e.$L,utc:e.$u,$offset:e.$offset})};var v=function(){function m(t){this.$L=this.$L||b(t.locale,null,!0),this.parse(t)}var f=m.prototype;return f.parse=function(t){this.$d=function(t){var e=t.date,a=t.utc;if(null===e)return new Date(NaN);if(w.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(u);if(r)return a?new Date(Date.UTC(r[1],r[2]-1,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)):new Date(r[1],r[2]-1,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)}return new Date(e)}(t),this.init()},f.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},f.$utils=function(){return w},f.isValid=function(){return!("Invalid Date"===this.$d.toString())},f.isSame=function(t,e){var a=g(t);return this.startOf(e)<=a&&a<=this.endOf(e)},f.isAfter=function(t,e){return g(t)<this.startOf(e)},f.isBefore=function(t,e){return this.endOf(e)<g(t)},f.$g=function(t,e,a){return w.u(t)?this[e]:this.set(a,t)},f.year=function(t){return this.$g(t,"$y",l)},f.month=function(t){return this.$g(t,"$M",o)},f.day=function(t){return this.$g(t,"$W",n)},f.date=function(t){return this.$g(t,"$D","date")},f.hour=function(t){return this.$g(t,"$H",r)},f.minute=function(t){return this.$g(t,"$m",a)},f.second=function(t){return this.$g(t,"$s",e)},f.millisecond=function(e){return this.$g(e,"$ms",t)},f.unix=function(){return Math.floor(this.valueOf()/1e3)},f.valueOf=function(){return this.$d.getTime()},f.startOf=function(t,i){var u=this,c=!!w.u(i)||i,m=w.p(t),f=function(t,e){var a=w.w(u.$u?Date.UTC(u.$y,e,t):new Date(u.$y,e,t),u);return c?a:a.endOf(n)},d=function(t,e){return w.w(u.toDate()[t].apply(u.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(e)),u)},h=this.$W,p=this.$M,y=this.$D,b="set"+(this.$u?"UTC":"");switch(m){case l:return c?f(1,0):f(31,11);case o:return c?f(1,p):f(0,p+1);case s:var g=this.$locale().weekStart||0,v=(h<g?h+7:h)-g;return f(c?y-v:y+(6-v),p);case n:case"date":return d(b+"Hours",0);case r:return d(b+"Minutes",1);case a:return d(b+"Seconds",2);case e:return d(b+"Milliseconds",3);default:return this.clone()}},f.endOf=function(t){return this.startOf(t,!1)},f.$set=function(s,i){var u,c=w.p(s),m="set"+(this.$u?"UTC":""),f=(u={},u[n]=m+"Date",u.date=m+"Date",u[o]=m+"Month",u[l]=m+"FullYear",u[r]=m+"Hours",u[a]=m+"Minutes",u[e]=m+"Seconds",u[t]=m+"Milliseconds",u)[c],d=c===n?this.$D+(i-this.$W):i;if(c===o||c===l){var h=this.clone().set("date",1);h.$d[f](d),h.init(),this.$d=h.set("date",Math.min(this.$D,h.daysInMonth())).toDate()}else f&&this.$d[f](d);return this.init(),this},f.set=function(t,e){return this.clone().$set(t,e)},f.get=function(t){return this[w.p(t)]()},f.add=function(t,i){var u,c=this;t=Number(t);var m=w.p(i),f=function(e){var a=g(c);return w.w(a.date(a.date()+Math.round(e*t)),c)};if(m===o)return this.set(o,this.$M+t);if(m===l)return this.set(l,this.$y+t);if(m===n)return f(1);if(m===s)return f(7);var d=(u={},u[a]=6e4,u[r]=36e5,u[e]=1e3,u)[m]||1,h=this.$d.getTime()+t*d;return w.w(h,this)},f.subtract=function(t,e){return this.add(-1*t,e)},f.format=function(t){var e=this;if(!this.isValid())return"Invalid Date";var a=t||"YYYY-MM-DDTHH:mm:ssZ",r=w.z(this),n=this.$locale(),s=this.$H,o=this.$m,i=this.$M,l=n.weekdays,u=n.months,m=function(t,r,n,s){return t&&(t[r]||t(e,a))||n[r].substr(0,s)},f=function(t){return w.s(s%12||12,t,"0")},d=n.meridiem||function(t,e,a){var r=t<12?"AM":"PM";return a?r.toLowerCase():r},h={YY:String(this.$y).slice(-2),YYYY:this.$y,M:i+1,MM:w.s(i+1,2,"0"),MMM:m(n.monthsShort,i,u,3),MMMM:m(u,i),D:this.$D,DD:w.s(this.$D,2,"0"),d:String(this.$W),dd:m(n.weekdaysMin,this.$W,l,2),ddd:m(n.weekdaysShort,this.$W,l,3),dddd:l[this.$W],H:String(s),HH:w.s(s,2,"0"),h:f(1),hh:f(2),a:d(s,o,!0),A:d(s,o,!1),m:String(o),mm:w.s(o,2,"0"),s:String(this.$s),ss:w.s(this.$s,2,"0"),SSS:w.s(this.$ms,3,"0"),Z:r};return a.replace(c,(function(t,e){return e||h[t]||r.replace(":","")}))},f.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},f.diff=function(t,u,c){var m,f=w.p(u),d=g(t),h=6e4*(d.utcOffset()-this.utcOffset()),p=this-d,y=w.m(this,d);return y=(m={},m[l]=y/12,m[o]=y,m[i]=y/3,m[s]=(p-h)/6048e5,m[n]=(p-h)/864e5,m[r]=p/36e5,m[a]=p/6e4,m[e]=p/1e3,m)[f]||p,c?y:w.a(y)},f.daysInMonth=function(){return this.endOf(o).$D},f.$locale=function(){return p[this.$L]},f.locale=function(t,e){if(!t)return this.$L;var a=this.clone(),r=b(t,e,!0);return r&&(a.$L=r),a},f.clone=function(){return w.w(this.$d,this)},f.toDate=function(){return new Date(this.valueOf())},f.toJSON=function(){return this.isValid()?this.toISOString():null},f.toISOString=function(){return this.$d.toISOString()},f.toString=function(){return this.$d.toUTCString()},m}();return g.prototype=v.prototype,g.extend=function(t,e){return t(e,v,g),g},g.locale=b,g.isDayjs=y,g.unix=function(t){return g(1e3*t)},g.en=p[h],g.Ls=p,g}))},6595:function(t,e,a){},"66ab":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Form",{ref:"form",attrs:{model:t.formData,"label-width":100}},[a("FormItem",{attrs:{label:"年份"}},[a("DatePicker",{staticStyle:{width:"200px"},attrs:{transfer:!0,format:"yyyy",options:t.options,type:"year",placeholder:"选择要导出的年份"},on:{"on-change":t.onChange}})],1)],1)},n=[],s={name:"export",props:{show:Boolean},data:function(){return{formData:{year:""},options:{disabledDate:function(t){return t&&t.valueOf()>Date.now()-864e5}}}},watch:{show:function(){this.show&&(this.formData.year="")}},mounted:function(){this.formData.year=""},methods:{onChange:function(t){console.log(t),this.formData.year=t},handleSubmit:function(){var t=this;return new Promise((function(e,a){t.$refs["form"].validate((function(r){r?e(t.formData):a(!1)}))}))}}},o=s,i=a("2877"),l=Object(i["a"])(o,r,n,!1,null,"154e642b",null);e["default"]=l.exports},"67ba":function(t,e,a){"use strict";var r=a("6595"),n=a.n(r);n.a},"67d3":function(t,e,a){"use strict";a.d(e,"b",(function(){return r})),a.d(e,"a",(function(){return n}));a("13cb");function r(t,e){return t("span",{style:{width:"12px",height:"12px",borderRadius:"50%",background:e.row[e.column.key]?"#1ba784":"#ff4000",display:"inline-block",boxShadow:"0 0 5px 0 ".concat(e.row[e.column.key]?"#1ba784":"#ff4000"),verticalAlign:"middle"}})}function n(t,e){return t("span",{},e.row.updateUserId?e.row.updateUserId:e.row.createUserId)}},a717:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{height:"100%"}},[t.flag?a("ComLayout",[a("ComGroupTree",{attrs:{slot:"left"},on:{changeTree:t.changeTree},slot:"left"}),a("tableTemplate",{attrs:{slot:"right",addModule:!1,handleSubmit:t.handleSubmit,modalParams:t.modalParams,columns:t.columns,seek:t.seek,params:t.params,dataCallBack:t.dataCallBack,title:t.title,newParams:t.newParams,titleSlot:!0},slot:"right"},[a("label",{staticClass:"titleLabel",attrs:{slot:"fun"},slot:"fun"},[a("a",{attrs:{href:"javascript:void(0)"},on:{click:t.exportForms}},[t._v("导出报表")]),a("a",{attrs:{href:"javascript:void(0)"},on:{click:t.exportExcel}},[t._v("导出欠费情况")])]),a("export",{ref:"export",attrs:{slot:"export",show:t.modalParams.show},slot:"export"}),a("payWS",{ref:"payWS",attrs:{slot:"payWS",show:t.modalParams.show,data:t.roleData,modalParams:t.modalParams},slot:"payWS"}),a("affirm",{ref:"affirm",attrs:{slot:"affirm",show:t.modalParams.show,data:t.affirmData,modalParams:t.modalParams},slot:"affirm"})],1)],1):a("tableTemplate",{attrs:{addModule:!1,handleSubmit:t.handleSubmit,modalParams:t.modalParams,columns:t.columns,seek:t.seek,params:t.params,dataCallBack:t.dataCallBack,title:t.title,newParams:t.newParams,titleSlot:!0}},[a("label",{staticClass:"titleLabel",attrs:{slot:"fun"},slot:"fun"},[a("a",{attrs:{href:"javascript:void(0)"},on:{click:t.exportForms}},[t._v("导出报表")]),a("a",{attrs:{href:"javascript:void(0)"},on:{click:t.exportExcel}},[t._v("导出欠费情况")])]),a("export",{ref:"export",attrs:{slot:"export",show:t.modalParams.show},slot:"export"}),a("payWS",{ref:"payWS",attrs:{slot:"payWS",show:t.modalParams.show,data:t.roleData,modalParams:t.modalParams},slot:"payWS"}),a("affirm",{ref:"affirm",attrs:{slot:"affirm",show:t.modalParams.show,data:t.affirmData,modalParams:t.modalParams},slot:"affirm"})],1)],1)},n=[],s=(a("8e6e"),a("ac6a"),a("456d"),a("96cf"),a("1da1")),o=a("ade3"),i=a("5a0c"),l=a.n(i),u=(a("7f7f"),a("67d3"));function c(){var t=this;return[{key:"groupName",align:"center",title:"表井名称",render:function(t,e){return t("span",{style:{color:e.row.balance-e.row.toPayWaterVolume<0?"rgb(255, 64, 0)":"#515a6e"}},e.row.groupName)}},{key:"villageName",title:"村名",align:"center",render:function(t,e){return t("span",{style:{color:e.row.balance-e.row.toPayWaterVolume<0?"rgb(255, 64, 0)":"#515a6e"}},e.row.villageName)}},{key:"userName",title:"用户名",align:"center",render:function(t,e){return t("span",{style:{color:e.row.balance-e.row.toPayWaterVolume<0?"rgb(255, 64, 0)":"#515a6e"}},e.row.userName)}},{key:"preNumber",title:"上期水表数",align:"center",render:function(t,e){return t("span",{style:{color:e.row.balance-e.row.toPayWaterVolume<0?"rgb(255, 64, 0)":"#515a6e"}},e.row.preNumber)}},{key:"lastNumber",title:"最新水表数",align:"center",render:function(t,e){return t("span",{style:{color:e.row.balance-e.row.toPayWaterVolume<0?"rgb(255, 64, 0)":"#515a6e"}},e.row.lastNumber)}},{key:"meterTypeName",title:"用水类型",align:"center",render:function(t,e){return t("span",{style:{color:e.row.balance-e.row.toPayWaterVolume<0?"rgb(255, 64, 0)":"#515a6e"}},e.row.meterTypeName)}},{key:"pulse",title:"方水/脉冲",align:"center",render:function(t,e){return t("span",{style:{color:e.row.balance-e.row.toPayWaterVolume<0?"rgb(255, 64, 0)":"#515a6e"}},e.row.pulse)}},{key:"online",title:"是否在线",align:"center",render:u["b"]},{key:"waterSum",title:"累计用水",align:"center",render:function(t,e){return t("span",{style:{color:e.row.balance-e.row.toPayWaterVolume<0?"rgb(255, 64, 0)":"#515a6e"}},e.row.waterSum)}},{key:"toPayWaterVolume",title:"待付用水量",align:"center",render:function(t,e){return t("span",{style:{color:e.row.balance-e.row.toPayWaterVolume<0?"rgb(255, 64, 0)":"#515a6e"}},e.row.toPayWaterVolume)}},{key:"toPayAccount",title:"欠费金额",align:"center",render:function(t,e){return t("span",{style:{color:e.row.balance-e.row.toPayWaterVolume<0?"rgb(255, 64, 0)":"#515a6e"}},e.row.toPayAccount)}},{key:"balance",title:"余额",align:"center",render:function(t,e){return t("span",{style:{color:e.row.balance-e.row.toPayWaterVolume<0?"rgb(255, 64, 0)":"#515a6e"}},e.row.balance)}},{key:"",title:"操作",align:"center",width:210,render:function(e,a){return e("ButtonGroup",[e("Button",{props:{type:"success",size:"small"},on:{click:function(){t.updateMeterDeal(a.row)}}},"抄表"),e("Button",{props:{type:"success",size:"small"},on:{click:function(){console.log(a.row),t.payWSCall(a.row)}}},"缴费")])}}]}function m(){var t=this;return[{type:"seek",key:"userSn",title:"用户名",data:[],remoteMethod:function(e){t.seek[0].loading=!0,t.api.findUser({name:e,current:1,size:99}).then((function(e){t.seek[0].data=e.data.records.map((function(t){return t.value=t.sn,t.name="".concat(t.name,"(").concat(t.phone||t.villageName,")"),t})),console.log(t.seek)})).finally((function(){t.seek[0].loading=!1}))},loading:!1},{type:"input",key:"phone",title:"手机号"},{type:"select",key:"meterTypeSn",title:"用水类型",data:[]}]}var f={current:1,size:10},d={show:!0,width:400,modalLoading:!0,type:"affirm",title:"缴费信息确认",maskClosable:!1},h="用水缴费",p=a("2f62");function y(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function b(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?y(Object(a),!0).forEach((function(e){Object(o["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var g={name:"Pay",props:{flag:{type:Boolean,default:!0}},data:function(){return{columns:c.call(this),seek:m.call(this),params:f,modalParams:d,roleData:{},title:h,api:this.$api.Pays,apiSys:this.$api.System,newParams:{villageSn:null,groupSn:null,userSn:null},affirmData:{}}},components:{payWS:a("3601").default,affirm:a("13e7").default,export:a("66ab").default},created:function(){var t=this;this.api.getWsFeeStandardAll().then((function(e){t.seek[2].data=e.data.map((function(t){return{value:t.sn,name:t.displayName}}))}))},mounted:function(){this.modalParams.show=!1,console.log(this.$refs)},methods:b(b({},Object(p["e"])(["setCount","showLoading","hideLoading"])),{},{dataCallBack:function(t){return this.api.getPay(t).then((function(t){return{content:t.data.records,total:t.data.total}}))},updateMeterDeal:function(t){var e=this;this.showLoading(),this.apiSys.updateMeterDeal(t).then((function(t){e.$Message.success("抄表成功!"),e.setCount(),e.hideLoading()})).catch((function(){e.setCount(),e.hideLoading()}))},handleSubmit:function(){var t=this;return this.$refs[this.modalParams.type].handleSubmit().then((function(e){return console.log(e),"payWS"===t.modalParams.type?(setTimeout((function(){Object.assign(t.affirmData,e),Object.assign(t.modalParams,{type:"affirm",show:!0,title:"缴费信息确认",okText:"确认"},500),console.log(t.$refs)})),Promise.resolve(e)):"export"!==t.modalParams.type?t.api.wsFeeLog(e).then((function(){if(t.setCount(),e.isSlip){console.log(e);var a=new FormData;return a.append("accountNum",e.toPayAccount),a.append("realPay",e.realPay),a.append("userName",e.userName),a.append("volume",e.toPayWaterVolume),a.append("balances",e.balance),t.api.print(a).then((function(e){return console.log(e),t.$Message.success("打印成功!"),Promise.resolve(e)})).catch((function(t){return Promise.reject(t)}))}t.$Message.success("".concat(e.userName?e.userName:"","缴费成功!"))})).catch((function(t){return Promise.reject(t)})):void t.api.postExportUserCostAndWaterSumToPdf(e).then((function(e){console.log(e,"<<<<<<<"),t.$saveFile(e.data,"".concat(l()(new Date).format("YYYY_MM_DD_hh_mm_ss_"),"报表.pdf"))}))}))},payWSCall:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.roleData={},Object.assign(this.roleData,e,{newTime:l()().format("YYYY-MM-DD hh:mm:ss")}),Object.assign(this.modalParams,{show:!0,modalLoading:!0,type:"payWS",title:"缴费",okText:"缴费"});case 3:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),exportForms:function(){Object.assign(this.modalParams,{type:"export",show:!0,title:"选择导出年份"})},exportExcel:function(){var t=this;this.api.postExportNoPay({userSn:"",villageSn:""}).then((function(e){console.log(e,"<<<<<<<"),t.$saveFile(e.data,"".concat(l()(new Date).format("YYYY_MM_DD_hh_mm_ss_"),"欠费情况.xlsx"))}))},changeTree:function(t){Object.assign(this.newParams,"village"===t.type&&{villageSn:t.sn,groupSn:null,userSn:null},"group"===t.type&&{villageSn:null,groupSn:t.sn,userSn:null},"user"===t.type&&{villageSn:null,groupSn:null,userSn:t.userSn}),this.setCount()}})},w=g,v=(a("58cd"),a("2877")),$=Object(v["a"])(w,r,n,!1,null,"1ae861b6",null);e["default"]=$.exports}}]);